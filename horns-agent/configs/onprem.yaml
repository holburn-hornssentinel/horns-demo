# Horns Agent Configuration - On-Premise Mode
#
# This configuration connects the agent to a customer-hosted gateway.
# Best for: Regulated industries (healthcare, finance), data sovereignty requirements.
#
# Data flow: Agent → Customer Gateway (internal network) → Dashboard
# Note: Data never leaves customer's network perimeter.

agent:
  name: "acme-db-01"
  version: "1.2.3"

  # Agent metadata
  tags:
    environment: "production"
    location: "on-premise-dc"
    compliance: "hipaa,pci-dss"
    data_classification: "confidential"

# Backend configuration
backend:
  type: "gateway"

  gateway:
    # Customer-hosted gateway endpoint (internal network)
    endpoint: "wss://horns-gateway.acme.local:8443"

    # Mutual TLS authentication
    auth:
      type: "mutual_tls"
      client_cert: "/etc/horns-agent/certs/client.crt"
      client_key: "/etc/horns-agent/certs/client.key"
      ca_cert: "/etc/horns-agent/certs/ca.crt"

    # Connection settings
    reconnect_interval: "30s"
    heartbeat_interval: "10s"

    # Data transmission
    batch_size: 50
    batch_timeout: "5s"

    # Network restrictions
    allowed_ips:
      - "10.0.0.0/8"  # Internal network only

    # TLS configuration
    tls:
      enabled: true
      verify_server: true
      min_version: "1.3"

# Collection modules
modules:
  # System metrics collection
  stockyard:
    enabled: true
    collect_interval: "30s"

    collectors:
      - system_info
      - processes
      - network_connections
      - docker_containers
      - file_integrity
      - database_metrics  # Additional for DB server

  # Security monitoring
  sentinel:
    enabled: true
    collect_interval: "60s"

    monitors:
      - vulnerability_scan
      - log_analysis
      - threat_detection
      - compliance_check
      - pci_dss_audit
      - hipaa_audit

# Data retention (local buffering during gateway outages)
local_buffer:
  enabled: true
  max_size: "10GB"
  retention: "7d"
  path: "/var/horns-agent/buffer"

# Privacy controls
privacy:
  # Mask sensitive data before transmission
  data_masking:
    enabled: true
    patterns:
      - credit_cards
      - ssn
      - passwords
      - api_keys

  # Exclude sensitive paths from file monitoring
  excluded_paths:
    - "/var/patient-data/*"
    - "/mnt/encrypted/*"

# Logging
logging:
  level: "info"
  format: "json"
  outputs:
    - type: "file"
      path: "/var/log/horns-agent/agent.log"
      max_size: "100MB"
      max_backups: 10
    - type: "syslog"
      address: "syslog.acme.local:514"
      protocol: "tcp"

# Resource limits
resources:
  max_memory: "1GB"
  max_cpu_percent: 15
